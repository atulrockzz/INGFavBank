pipeline{
agent any 
stages{
stage('Git Checkout'){
steps{
git 'https://github.com/atulrockzz/INGFavBank.git'
     }                }
   stage('java build'){
   steps{
             sh '/opt/maven/bin/mvn clean verify sonar:sonar -Dsonar.password=admin -Dsonar.login=admin'
         } }
   stage("build & SonarQube analysis") {
   steps{
              withSonarQubeEnv('sonar') {
              
                 sh '/opt/maven/bin/mvn clean deploy sonar:sonar'
              } }
          }
      
   stage('Running java backend application'){
   steps{
             sh 'export JENKINS_NODE_COOKIE=dontKillMe ;nohup java -Dspring.profiles.active=sit -jar $WORKSPACE/target/*.jar &'
         }}
         stage('Tomcat Deploy'){
         steps{
         deploy adapters: [tomcat9(credentialsId: 'Tomcat', path: '', url: 'http://18.221.45.191:8888')], contextPath: 'Favbank', war: '**/*.war'
  }}
}
}
